


			温控项目控制板

			模块程序编写：冉川

一、功能
	1.能够接受上位机的命令并执行相关动作
	2.可以读取当前的控制状态，可以返回给上位机
	3.
二、实现
	1.通过无线模块与上位机通讯
	2.目前只控制开关量，用几个引脚
	3.
三、逻辑
	1.通过串口中断接受命令，命令接受完成后通过标志位通知主函数命令接受完成，
	  可以进行命令解码了
	2.在主函数里查询标志位，如果可以进行命令解码就解码命令
	3.执行命令


2018.3.6 
	弄懂了无线

2018.3.7
	用定时器写了红外载波发送程序，用于遥控空调
2018.3.14
	f0 fe 01 06 00 00 00 02 01 02 bb fd
	控制打开空调降温
	完成了对控制命令的解析，加入了CRC校验
2018.3.15
	f0 fe 01 06 00 00 00 02 01 03 7a 3d
	控制除湿机开
	f0 fe 01 06 00 00 00 02 00 03 7b ad
	控制除湿机关
	f0 fe 01 03 00 02 00 04 b5 52
	读取控制器状态
2018.3.16
	集中器，采集器，控制器，通信成功
2018.3.21
	1.修改串口接收逻辑，使之更稳定
	2.增加控制器类型标识，区分除湿机控制器，空调控制器，空气净化器控制器
2018.3.30
	移植在温控控制电路板上
2018.4.12
	拟实现一个控制板控制多个设备，还没开始改


2018.5.30
	1.
	通过按键KEY进入配置模式
	进入配置模式可以进行控制器类型、地址等配置，
	短按KEY测试控制板的各种控制动作，长按退出配置模式
	2.
	可以通过红外控制格力、美的空调，具体控制什么品牌通过配置信息确定

2018.5.31
	控制器有两种工作模式：
	1.单纯控制模式，集中器给控制器发控制命令，直接控制控制器开或关，协议不变
	2.自主解析控制模式，集中器只需要把临界值和当前环境参数发给控制器，控制器自己判断该怎么控制，需要新增协议
	3.在工作模式2下，由监听模式，可以开启控制器直接监听采集器的返回值

2018.6.8
	控制器可以配置环境变量的上下限
	加了漏水报警通过485读取
	状态返回通过主机欲读取的数据长度返回，全返回信息长度是21位，包括错误信息和所有控制器状态

2018.6.19
	空调红外可以学习，不解码，存储遥控数据的电平信号。

	格力开
	10010000   10010000   00000100   10001010   0100 0000   00000000   01000000   00000000   11110000   

2018.6.22
	空调红外命令只发送一次，去掉空调每隔一段时间会响一声的问题

2018.6.24
	修复红外发射头在没有发送红外数据的时候处于常开状态的BUG

2018.6.27
	空气净化器可以用红外遥控，增加空气净化器遥控值的学习和控制

2018.6.29
	控制板更新协议，相比之前的更合理

2018.7.30
	控制板去掉除湿机CD冷却，
2018.8.13
	加大自定义红红外遥控键值buff
2018.8.15
	加入了新协议下的配置命令
2018.8.16
	优化设备类型指示灯的显示，加湿机和除湿机使用同一个指示灯
	控制板的功能全部实现
2018.8.17
	修复设备运行时间计时不准确的问题
2018.9.12
	更改为IAP程序，
2018.9.14
	使用串口空闲中断，提高接收控制命令成功率
2018.9.20
	解决从格力空调或美的空调配置为自定义之后，要在重启之后才能正常学习空调命令的BUG
	解决空调进入学习状态之后短暂延迟之后自动退出学习模式的BUG
	增加复位命令
2018.10.11
	除湿机控制加入湿度值设定
2019.1.9
	居然又出现了不能学习遥控键值的情况，，，，，，原因是接收数组被清空
	乱七八糟改了一下可以了
2019.1.30
	解决了空调遥控了几次之后会丢失配置信息的问题，原因是定时器捕获在定时器不计时时也会触发捕获中断，再捕获中断中给内存赋值0
2019.3.29
	解决除湿机一直发送漏水报警的bug
2019.4.19
	控制器修改0x04命令的实现，
	单片机前1KB内存用作公用内存，可以通过命令来读写
	每个运行周期检测内存是否相同，若不同则执行至相同
2019.4.19
	重新建立控制板工程
	控制板软件升级为V3.5



